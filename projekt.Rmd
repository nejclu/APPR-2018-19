---
title: "Analiza stopnje sreče ljudi v državah po svetu"
author: "Nejc Lukežič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

V projektu bom analiziral stopnjo sreče ljudi po posameznih državah v svetu med letoma 2015 in 2017.Za vsako izmed 148 držav je podano število na lestvici od 1 do 10, ki predstavlja mero sreče ljudi v državi, ta pa je seštevek sedmih komponent – šestih glavnih (BDP države, pričakovana življenjska doba, svoboda, radodarnost, korupcija, pomen družine) in dodatne komponente, ki je seštevek rezultata izmišljene države z najmanj srečnimi državljani (»Dystopia«) in ocene napake pri končnem rezultatu vsake države, ki jo da prvih 6 spremenljivk. Pri tem bom skušal ugotoviti kateri izmed faktorjev so najpomembnejši za srečnejše življenje, koliko se stopnja sreče ljudi po državah spreminja tekom treh let (2015 – 2017) in če je katera izmed držav doživela velik skok ali padec v stopnji sreče v tem obdobju. Podatke bom primerjal tudi po celinah. Kot dodatni spremenljivki sem si izbral število in prirast prebivalcev določene države, zanimalo pa me bo ali obstaja kakšna korelacija med stopnjo sreče ljudi in številom ljudi, ki živi v določeni državi oziroma njegovim prirastom.


# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke o stopnji sreče ljudi sem uvozil v obliki CSV s spletne strani Kaggle, podatke o številu prebivalcev in prirastu držav pa v obliki HTML z Wikipedije. Podatke imam v dveh razpredelnicah v obliki *tidy data*.

1. `Stopnja sreče ljudi` - podatki o stopnji sreče ljudi za
  - `Država (Country)` - spremenljivka: ime države (besedilo)
  - `Leto (Year)` - spremenljivka: leto, katerega so bile opravljene meritve (celo število)
  - `Mesto na lestvici (Happiness Rank)` - meritev: Od 1 do 148 (celo število)
  - `BDP (Economy-GDP per capita)` - meritev: v kolikšni meri BDP določene države vpliva na izračun stopnje sreče ljudi (celo število)
  - `Družina (Family)` - meritev: v kolikšni meri pomen družine vpliva na izračun stopnje sreče ljudi (število)
  - `Pričakovana življenjska doba (Health - life expectancy)` - meritev: v kolikšni meri pričakovana življenjska doba vpliva na izračun stopnje sreče ljudi (število)
  - `Svoboda (Freedom)` - meritev: v kolikšni meri svoboda odločanja vpliva na izračun stopnje sreče ljudi (število)
  - `Korupcija (Trust - Government corruption)` - meritev: v kolikšni meri korupcija (oziroma njena odsotnost) vpliva na izračun stopnje sreče ljudi (število)
  - `Radodarnost (Generosity)` - meritev: v kolikšni meri radodarnost ljudi vpliva na izračun stopnje sreče (število)
  - `Dystopia + residual` - meritev: v kolikšni meri rezultat države »Dystopia« in ocena napake prejšnjih meritev vpliva na izračun stopnje sreče ljudi (število)
  
2. `Prebivalstvo` - podatki o prebivalstvu po državah
  - `Država (Country)` - spremenljivka: ime države (besedilo)
  - `Prebivalstvo (Population)` - spremenljivka: Število ljudi v določeni državi (izmerjeno leta 2016) (celo število)
  - `Prirast (Change)` - spremenljivka: razlika med številom ljudi, ki živi v državi med letoma 2016 in 2017 (izraženo v procentih) (število)



***

<!-- # Analiza in vizualizacija podatkov -->

<!-- ```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'} -->
<!-- source("vizualizacija/vizualizacija.r", encoding="UTF-8") -->
<!-- ``` -->

<!-- Spodnji zemljevid prikazuje povprečno velikost družine za vsako občino. -->

<!-- ```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'} -->
<!-- ggplot() + geom_polygon(data=left_join(zemljevid, povprecja, by=c("OB_UIME"="obcina")), -->
<!--                         aes(x=long, y=lat, group=group, fill=povprecje)) + -->
<!--   ggtitle("Povprečno število otrok v družini") + xlab("") + ylab("") + -->
<!--   guides(fill=guide_colorbar(title="Povprečje")) -->
<!-- ``` -->

<!-- *** -->

<!-- # Napredna analiza podatkov -->

<!-- ```{r analiza, echo=FALSE, message=FALSE} -->
<!-- source("analiza/analiza.r", encoding="UTF-8") -->
<!-- ``` -->

<!-- Spodnji graf prikazuje povezavo med številom naselij in površino občine. -->

<!-- ```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'} -->
<!-- ggplot(inner_join(obcine, data.frame(obcina=names(skupine), -->
<!--                                      skupina=factor(skupine)), by="obcina") -->
<!-- , aes(x=povrsina, y=naselja, color=skupina, size=prebivalci/1000)) + geom_point() + -->
<!--   ggtitle("Število naselij glede na površino občine") + -->
<!--   xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") + -->
<!--   guides(color=guide_legend(title="Skupina"), -->
<!--          size=guide_legend(title="Prebivalci (* 1000)")) -->
<!-- ``` -->

<!-- *** -->

<!-- ```{r shiny, echo=FALSE} -->
<!-- shinyAppDir("shiny", options=list(width="100%", height=600)) -->
<!-- ``` -->
